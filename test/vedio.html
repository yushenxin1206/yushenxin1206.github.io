<!DOCTYPE html>
<html>
<head>
<title>normal template</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style type="text/css">
*{margin:0;padding:0;}
	
/*隐藏下载控件*/
video::-internal-media-controls-download-button { display:none;}
video::-webkit-media-controls-enclosure{ overflow: hidden; }
video::-webkit-media-controls-panel{ width: calc(100% + 32px);}
	
/*横竖屏*/
@media screen and (orientation : portrait){
	/*竖屏*/
}
@media screen and (orientation : landscape){
}
	
body{
	padding: 0 16px;
}
@font-face{
    font-family: '';
    src : url('../fonts/yaheiconsolashybrid.ttf');
}
.s1{
	font-family: Arail; /* 字体 */
	font-size:; 14px/* 文字大小 */
	color: #ccc;/*文字颜色*/
	text-align: center; /*文字对齐样式 居中：center 左对齐：left 右对齐：right*/
	line-height: 1;/*行间距*/
}
/*设置图片模块*/
.img-md{
	max-width: 100%;
	white-space: nowrap;
	overflow-x: scroll;
}
.img-md div{
	display: inline-block;
	max-width: 100%;
	text-align: center;
}
.img-md img{
	max-width: 100%;
	margin: 0 auto;
}
.more-img{
	color: #999;
	font-size: 12px;
	text-align: center;
	margin-bottom: 40px;
}
	
/*视频模块*/
.video-session{
	position: relative;
	display: flex;
	max-width: 100%;
	align-content: center;
	align-items: center;
}
video{
	display: block;
	max-width: 100%;
	margin: 0 auto;
	transition: all 1s;
}
.fs{
	position: fixed;
	top: 0;left: 0;right: 0;bottom: 0;
	background: #000;
	z-index: 9999;
}
/*底部控件*/
.control{
	height: 32px;
	background: rgba(0,0,0,.54);
	position: absolute;
	bottom: 0;
	width: 100%;
}
.ctime{
	float: left;
	height: 32px;
	line-height: 32px;
	margin: 0 16px;
	font-size: 13px;
	color: #fff;
}
.process{
	height: 4px;
	background: rgba(255,255,255,.6);
	position: absolute;
	left: 64px;
	right: 112px;
	top: 14px;
	border-radius: 2px;
}
.ttime{
	float: right;
	height: 32px;
	line-height: 32px;
	margin-left: 16px;
	font-size: 13px;
	color: #fff;
}
.full-screen{
	height: 32px;
	width: 32px;
	line-height: 32px;
	float: right;
	margin: 0 16px;
	background: url("./fs.svg") 6px 6px / 20px 20px no-repeat;
}
.pause,.play{
	display: none;
	height: 48px;
	width: 48px;
	background: url("./ps.svg") 0 0 / 100% 100% no-repeat;
	position: absolute;
	top: calc(50% - 24px);
	left: calc(50% - 24px);
}
.play{
	display: block;
	background: url("./pl.svg") 0 0 / 100% 100% no-repeat;
}
h2,p{text-align: center; margin: 20px 0;}
</style>
<script type="text/javascript" src="./jquery-3.3.1.min.js"></script>
</head>

<body>

<h2 class="">视频1</h2>
<p class="">正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文</p>
<div class="video-session">
	<video data-cs="0" src="http://lfmemberdev.hwcloudtest.cn:9094/files/httpserver/MODEL/EMUI/C00B050TEMP/resource/card/20180820150724/image/video/1-10044802_f003_Gesture%20Navigation.mp4">您的浏览器不支持 video 标签</video>
	<div class="control">
		<div class="ctime">0:00</div>
		<div class="process"></div>
		<div class="full-screen"></div>
		<div class="ttime">0:00</div>
	</div>
	<div class="pause"></div>
	<div class="play"></div>
</div>
	

<h2 class="">视频2</h2>
<p class="">正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文</p>
<video src="http://lfmemberdev.hwcloudtest.cn:9094/files/httpserver/MODEL/EMUI/C00B050TEMP/resource/card/20180820150724/image/video/1-10045865_f002_Slipt%20Screen.mp4">您的浏览器不支持 video 标签</video>



<h2 class="">视频3</h2>
<p class="">正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文</p>
<video x-webkit-airplay="true" playsinline="true" x5-playsinline="true" webkit-playsinline="true" src="http://lfmemberdev.hwcloudtest.cn:9094/files/httpserver/MODEL/EMUI/C00B050TEMP/resource/card/20180820150724/image/video/1-10045865_f002_Slipt%20Screen.mp4" controls>您的浏览器不支持 video 标签</video>

<script>
	
	$(function(){
		var pVideo;
		var mOrientation;
		var process;
		var $fsVideo;
		
		var $video = $("video");
		console.log($video);
		
		/*初始化横竖屏值*/
		getOrientation();
		
		/*初始化视频时间*/
		for(var i=0;i<$video.length;i++){
			
			$video[i].oncanplaythrough = function(){
				var $ttime = $(this).parent().find(".control .ttime").eq(0);
				var ttime = this.duration;
				$ttime.html(sec2min(ttime));
				
			}
			
		}
		
		/*
		* 设置同时只有一个视频处于播放状态
		*/
		$video.on('play',function(){
			pVideo = this;
			
			$(this).parent().find(".control").slideUp();
			$(this).parent().find(".pause").hide();
			
			if(process){
				clearInterval(process);
			}
			upDataProcess();
			
			for(var i=0;i<$video.length;i++){
				if(this != $video[i]){
					$video[i].pause();
				}
			}
		});
		/*视频暂停 停止*/
		$video.on('pause',function(){
			
			$(this).parent().find(".control").slideDown();
			$(this).parent().find(".pause").hide();
			$(this).parent().find(".play").show();
			
			//停止
			if(this.currentTime == this.duration){
				
			}
			//暂停
			if(this.currentTime < this.duration){
				
			}
	
		});
		
		$(".pause").click(function(){
			var $v = $(this).parent().find("video")[0];
			$v.pause();
			$(this).parent().find(".play").show();
			$(this).hide();
			$v.dataset.cs = "1";
			event.stopPropagation();
		});
		
		$(".play").click(function(){
			var $v = $(this).parent().find("video")[0];
			$v.play();
			$(this).fadeOut();
			$(this).parent().find(".control").slideUp();
			$v.dataset.cs = "0";
			event.stopPropagation();
		});
		
		$(".video-session").click(function(){
			var v = $(this).find("video")[0];
			if(v.paused){ return false;}
			pCtrlShow(v);
		});
		
		/*不在屏幕范围内的视频停止播放*/
		window.addEventListener('scroll', function () {
			if(pVideo){
				if($(pVideo).offset()["top"]<$(window).scrollTop()-$(pVideo).height()){
					pVideo.pause();
				}
				
				if($(pVideo).offset()["top"] - $(window).scrollTop()- window.innerHeight >0){
					pVideo.pause();
				}
				
			}
		});
		
		/*竖屏状态旋转90度 横屏状态不旋转*/
		$(".full-screen").click(function(){
		
			var $v = $(this).parent().parent().find("video").eq(0);
			$fsVideo = $v;
			$v.parent().addClass("fs");
			
		});
								 
		/*判断横竖屏状态*/
		function getOrientation(){
			if(window.orientation==180||window.orientation==0){
				mOrientation = 0;
			}
			if(window.orientation==90||window.orientation==-90){
				mOrientation = 1;
			}
		}
		/*设置video状态*/
		function setVideoOrientation(){
			getOrientation();
			if(!$fsVideo){return false;}
			if(mOrientation){
				$fsVideo.height("100vh");
			}else{
				$fsVideo.width("100vw");
			}
		}
		window.addEventListener("onorientationchange" in window ? "orientationchange" : "resize", setVideoOrientation, false);
		
		/*更新控件条*/
		function upDataProcess(){
			var $process = $(pVideo).parent().find(".control .process").eq(0);
			var $ctime = $(pVideo).parent().find(".control .ctime").eq(0);
			var $ttime = $(pVideo).parent().find(".control .ttime").eq(0);
			var ttime = pVideo.duration;
			
			$ttime.html(sec2min(ttime));
			
			process = setInterval(function(){
				var ctime = pVideo.currentTime;
				var percent = ctime*100/ttime+"%";
				$process.css("background","linear-gradient(to right, #FFFFFF "+percent+" , rgba(255,255,255,.6) "+percent+")");
				$ctime.html(sec2min(ctime));
			},100);
	
		}
		
		/*秒转分秒*/
		function sec2min(t){
			
			t = Math.round(t);
			var m = Math.floor(t/60);
			var s = t%60;
			if(s<10){
				s = "0"+s;
			} 
			return m+":"+s;
		}
		
		/*播放时控件条的显示与隐藏*/
		function pCtrlShow(v){
			
			//避免重复触发
			console.log(v.dataset.cs);
			
			if(v.dataset.cs === "1"){
				return false;
			}else{
				v.dataset.cs = "1";
			}
			
			$(v).parent().find(".control").slideDown();
			$(v).parent().find(".pause").fadeIn();
			setTimeout(function(v){
				if(v.paused){
					return false;
				}
				$(v).parent().find(".control").slideUp();
				$(v).parent().find(".pause").hide();
				v.dataset.cs = "0";
			},3000,v);
		}
		
	});
	
</script>
</body>

</html>
